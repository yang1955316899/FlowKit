import{d as a,r as s,e as l,C as e,y as t,L as n,I as o,f as i,F as c,h as r,x as v,g as u,t as d,i as p,o as m,n as y}from"./vendor-BnMKHz0r.js";import{t as h}from"./tokens-CUAMeXud.js";import{i as f}from"./echarts-C-8LDSbe.js";import{_ as k}from"./index-Brv2IJXv.js";const g=a("dashboard",()=>{const a=s([]),l=s(0),e=s(null),t=s([]),n=s(!1),o=s(!0),i=s(null),c=async a=>{const s=void 0!==a?a:l.value;n.value=!0;try{e.value=await h.getStats(s)}catch(t){e.value=null}finally{n.value=!1}},r=async a=>{const s=void 0!==a?a:l.value;try{t.value=await h.getDetails(s)}catch(e){t.value=[]}};return{tokens:a,currentTokenIdx:l,stats:e,details:t,loading:n,autoRefresh:o,fetchTokens:async()=>{try{a.value=await h.getAll()}catch(s){}},fetchStats:c,fetchDetails:r,selectToken:async a=>{l.value=a,await Promise.all([c(a),r(a)])},startAutoRefresh:()=>{i.value||(i.value=window.setInterval(()=>{o.value&&(c(),r())},2e4))},stopAutoRefresh:()=>{i.value&&(clearInterval(i.value),i.value=null)}}}),x={class:"dashboard"},b={key:0,class:"token-tabs"},_=["onClick"],w={key:1,class:"loading"},S={class:"metrics"},T={class:"metric"},A={class:"m-val"},R={class:"metric"},I={class:"m-val"},L={class:"metric"},j={class:"m-val"},C={class:"metric"},F={class:"m-val"},q={class:"detail-card"},z={class:"d-row"},D={class:"d-val"},$={class:"d-row"},O={class:"d-val"},P={class:"d-row"},B={class:"d-val"},E={class:"d-row"},G={class:"d-val"},H={class:"d-row"},J={class:"d-val"},K={class:"chart-card"},M=k(l({__name:"index",setup(a){const l=g(),h=s();let k=null;const M=p(()=>l.tokens),N=s(0),Q=p(()=>l.stats),U=p(()=>l.details),V=p(()=>l.loading),W=a=>a>=1e3?(a/1e3).toFixed(1)+"k":String(a||0),X=()=>{var a;h.value&&(null==(a=U.value)?void 0:a.length)&&(k||(k=f(h.value)),k.setOption({backgroundColor:"transparent",grid:{top:10,right:10,bottom:24,left:36},tooltip:{trigger:"axis"},xAxis:{type:"category",data:U.value.map(a=>a.date),axisLabel:{fontSize:9,color:"#6c7086"},axisLine:{lineStyle:{color:"#252538"}}},yAxis:{type:"value",axisLabel:{fontSize:9,color:"#6c7086"},splitLine:{lineStyle:{color:"#252538"}}},series:[{type:"line",data:U.value.map(a=>a.requests),smooth:!0,itemStyle:{color:"#89b4fa"},areaStyle:{color:"rgba(137,180,250,0.15)"},lineStyle:{width:2},symbolSize:4}]}))};return e(U,()=>n(X)),t(async()=>{await l.fetchTokens(),M.value.length&&(await l.selectToken(0),n(X)),l.startAutoRefresh()}),o(()=>{l.stopAutoRefresh(),null==k||k.dispose()}),(a,s)=>{var e,t;return m(),i("div",x,[M.value.length>1?(m(),i("div",b,[(m(!0),i(c,null,r(M.value,(a,s)=>{var e;return m(),i("button",{key:s,class:y(["token-pill",{active:N.value===s}]),onClick:a=>(a=>{N.value=a,l.selectToken(a)})(s)},d((null==(e=a.name)?void 0:e.slice(0,5))||"T"+(s+1)),11,_)}),128))])):v("",!0),V.value?(m(),i("div",w,"加载中...")):Q.value?(m(),i(c,{key:2},[u("div",S,[u("div",T,[u("span",A,d(Q.value.requests_today),1),s[0]||(s[0]=u("span",{class:"m-label"},"今日请求",-1))]),u("div",R,[u("span",I,d(W(Q.value.tokens_today)),1),s[1]||(s[1]=u("span",{class:"m-label"},"Tokens",-1))]),u("div",L,[u("span",j,"$"+d((null==(e=Q.value.cost_today)?void 0:e.toFixed(2))||"0.00"),1),s[2]||(s[2]=u("span",{class:"m-label"},"费用",-1))]),u("div",C,[u("span",F,d(Q.value.remaining_days),1),s[3]||(s[3]=u("span",{class:"m-label"},"剩余天数",-1))])]),u("div",q,[u("div",z,[s[4]||(s[4]=u("span",null,"总请求",-1)),u("span",D,d(Q.value.total_requests),1)]),u("div",$,[s[5]||(s[5]=u("span",null,"总 Tokens",-1)),u("span",O,d(W(Q.value.total_tokens)),1)]),u("div",P,[s[6]||(s[6]=u("span",null,"总费用",-1)),u("span",B,"$"+d((null==(t=Q.value.total_cost)?void 0:t.toFixed(2))||"0.00"),1)]),u("div",E,[s[7]||(s[7]=u("span",null,"每日限额",-1)),u("span",G,d(Q.value.daily_limit||"--"),1)]),u("div",H,[s[8]||(s[8]=u("span",null,"到期日期",-1)),u("span",J,d(Q.value.expire_date||"--"),1)])]),u("div",K,[u("div",{ref_key:"chartRef",ref:h,class:"chart"},null,512)])],64)):v("",!0)])}}}),[["__scopeId","data-v-42a93f00"]]);export{M as default};
