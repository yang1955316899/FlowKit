import{e,y as a,I as l,j as t,f as o,q as s,F as n,h as c,x as i,m as u,o as d,n as p,t as r,g as v,C as y,z as m,D as h,J as b,A as g,v as k,i as f,r as w,K as x,k as C,B as A}from"./vendor-BnMKHz0r.js";import{_,u as D,a as U,i as j,o as I,b as K}from"./index-Brv2IJXv.js";const L=["onClick"],T={key:0,class:"item-icon"},V={class:"item-label"},E={key:1,class:"item-shortcut"},S=_(e({__name:"ContextMenu",props:{show:{type:Boolean},x:{},y:{},items:{}},emits:["close"],setup(e,{emit:y}){const m=e,h=y,b=()=>h("close"),g=e=>{m.show&&b()};return a(()=>{document.addEventListener("click",g)}),l(()=>{document.removeEventListener("click",g)}),(a,l)=>(d(),t(u,{to:"body"},[e.show?(d(),o("div",{key:0,class:"context-menu",style:s({left:e.x+"px",top:e.y+"px"}),onClick:b},[(d(!0),o(n,null,c(e.items,(e,a)=>(d(),o("div",{key:a,class:p(["menu-item",{disabled:e.disabled,danger:e.danger}]),onClick:a=>!e.disabled&&(e=>{e.action(),b()})(e)},[e.icon?(d(),o("span",T,r(e.icon),1)):i("",!0),v("span",V,r(e.label),1),e.shortcut?(d(),o("span",E,r(e.shortcut),1)):i("",!0)],10,L))),128))],4)):i("",!0)]))}}),[["__scopeId","data-v-54388b9f"]]),R={class:"modal-header"},B={class:"modal-title"},F={class:"modal-body"},M={class:"form-group"},O=["disabled"],P={class:"form-group"},H={class:"form-group"},J={class:"form-group"},N={key:0,class:"form-group"},Y=["placeholder"],q={key:1,class:"form-group"},z={class:"steps-list"},W={class:"step-num"},X={class:"step-type"},$=["onClick"],G={key:2,class:"form-group"},Q=_(e({__name:"ActionEditor",props:{show:{type:Boolean},action:{}},emits:["close","save"],setup(e,{emit:a}){const l=e,t=a,s=f(()=>!!l.action),u=w({type:"app",label:"",icon:"",hotkey:"",target:"",steps:[],delay:500});y(()=>l.show,e=>{e&&l.action?u.value={type:l.action.type,label:l.action.label,icon:l.action.icon,hotkey:l.action.hotkey||"",target:l.action.target||"",steps:l.action.steps||[],delay:l.action.delay||500}:e&&(u.value={type:"app",label:"",icon:"âœ¦",hotkey:"",target:"",steps:[],delay:500})});const p=f(()=>["app","url","shell","snippet","keys","script"].includes(u.value.type)),x=f(()=>({app:"åº”ç”¨è·¯å¾„",url:"ç½‘å€",shell:"å‘½ä»¤",snippet:"æ–‡æœ¬å†…å®¹",keys:"æŒ‰é”®åºåˆ—",script:"è„šæœ¬ä»£ç "}[u.value.type]||"ç›®æ ‡")),C=f(()=>({app:"C:\\Program Files\\App\\app.exe",url:"https://example.com",shell:"echo Hello",snippet:"è¦å¤åˆ¶çš„æ–‡æœ¬",keys:"ctrl+c",script:'print("Hello")'}[u.value.type]||"")),A=e=>{e.preventDefault();const a=[];e.ctrlKey&&a.push("ctrl"),e.shiftKey&&a.push("shift"),e.altKey&&a.push("alt"),e.metaKey&&a.push("meta");const l=e.key.toLowerCase();["control","shift","alt","meta"].includes(l)||a.push(l),a.length>0&&(u.value.hotkey=a.join("+"))},_=()=>{u.value.steps.push({type:"delay",duration:1e3})},D=()=>t("close"),U=()=>{const e={type:u.value.type,label:u.value.label,icon:u.value.icon,hotkey:u.value.hotkey||void 0};p.value&&(e.target=u.value.target),"combo"===u.value.type&&(e.steps=u.value.steps,e.delay=u.value.delay),t("save",e)};return(a,l)=>e.show?(d(),o("div",{key:0,class:"modal-mask",onClick:D},[v("div",{class:"modal-box",onClick:l[6]||(l[6]=k(()=>{},["stop"]))},[v("div",R,[v("span",B,r(s.value?"ç¼–è¾‘åŠ¨ä½œ":"æ–°å»ºåŠ¨ä½œ"),1),v("button",{class:"close-btn",onClick:D},"Ã—")]),v("div",F,[v("div",M,[l[8]||(l[8]=v("label",null,"ç±»å‹",-1)),m(v("select",{"onUpdate:modelValue":l[0]||(l[0]=e=>u.value.type=e),disabled:s.value},[...l[7]||(l[7]=[b('<option value="app" data-v-cb6d4c8d>åº”ç”¨</option><option value="url" data-v-cb6d4c8d>ç½‘å€</option><option value="combo" data-v-cb6d4c8d>ç»„åˆ</option><option value="shell" data-v-cb6d4c8d>å‘½ä»¤</option><option value="snippet" data-v-cb6d4c8d>æ–‡æœ¬</option><option value="keys" data-v-cb6d4c8d>æŒ‰é”®</option><option value="script" data-v-cb6d4c8d>è„šæœ¬</option>',7)])],8,O),[[h,u.value.type]])]),v("div",P,[l[9]||(l[9]=v("label",null,"æ ‡ç­¾",-1)),m(v("input",{"onUpdate:modelValue":l[1]||(l[1]=e=>u.value.label=e),placeholder:"åŠ¨ä½œåç§°"},null,512),[[g,u.value.label]])]),v("div",H,[l[10]||(l[10]=v("label",null,"å›¾æ ‡",-1)),m(v("input",{"onUpdate:modelValue":l[2]||(l[2]=e=>u.value.icon=e),placeholder:"emoji å›¾æ ‡",maxlength:"2"},null,512),[[g,u.value.icon]])]),v("div",J,[l[11]||(l[11]=v("label",null,"å¿«æ·é”®",-1)),m(v("input",{"onUpdate:modelValue":l[3]||(l[3]=e=>u.value.hotkey=e),placeholder:"ä¾‹å¦‚: ctrl+shift+a",onKeydown:A},null,544),[[g,u.value.hotkey]])]),p.value?(d(),o("div",N,[v("label",null,r(x.value),1),m(v("input",{"onUpdate:modelValue":l[4]||(l[4]=e=>u.value.target=e),placeholder:C.value},null,8,Y),[[g,u.value.target]])])):i("",!0),"combo"===u.value.type?(d(),o("div",q,[l[12]||(l[12]=v("label",null,"æ­¥éª¤",-1)),v("div",z,[(d(!0),o(n,null,c(u.value.steps,(e,a)=>(d(),o("div",{key:a,class:"step-item"},[v("span",W,r(a+1),1),v("span",X,r(e.type),1),v("button",{class:"step-del",onClick:e=>(e=>{u.value.steps.splice(e,1)})(a)},"Ã—",8,$)]))),128)),v("button",{class:"add-step-btn",onClick:_},"+ æ·»åŠ æ­¥éª¤")])])):i("",!0),"combo"===u.value.type?(d(),o("div",G,[l[13]||(l[13]=v("label",null,"å»¶è¿Ÿ (ms)",-1)),m(v("input",{"onUpdate:modelValue":l[5]||(l[5]=e=>u.value.delay=e),type:"number",min:"0"},null,512),[[g,u.value.delay,void 0,{number:!0}]])])):i("",!0)]),v("div",{class:"modal-footer"},[v("button",{class:"btn-cancel",onClick:D},"å–æ¶ˆ"),v("button",{class:"btn-save",onClick:U},"ä¿å­˜")])])])):i("",!0)}}),[["__scopeId","data-v-cb6d4c8d"]]),Z={class:"page-name"},ee=["draggable","onClick","onContextmenu","onDragstart","onDragover","onDrop"],ae={class:"cell-icon"},le={class:"cell-label"},te={key:0,class:"group-badge"},oe={key:0,class:"page-dots"},se=["onClick"],ne=_(e({__name:"index",setup(e){const l=D(),t=U(),{success:u,error:y}=K(),h=w(),b=w(""),_=w(null),L=f(()=>l.currentPage),T=f(()=>l.pageName),V=f(()=>l.totalPages),E=f(()=>l.actions),R=f(()=>({gridTemplateColumns:"repeat(4, 1fr)",gridTemplateRows:"repeat(7, 52px)"})),B=f(()=>{const e=[...E.value];for(;e.length<28;)e.push(null);return e.slice(0,28)}),F=e=>{if(!e)return"";let a=0,l="";for(const t of e){const e=t.charCodeAt(0)>11904?2:1;if(a+e>8)return l+"..";l+=t,a+=e}return l},M=()=>{var e;return null==(e=h.value)?void 0:e.focus()},O=()=>{b.value.trim()?l.search(b.value):l.clearSearch()},P=()=>{b.value="",l.clearSearch()},H=async e=>{try{await l.executeAction(e)}catch{y("æ‰§è¡Œå¤±è´¥")}},J=e=>l.fetchActions(e),N=e=>{V.value<=1||(e.deltaY<0?J(Math.max(0,L.value-1)):J(Math.min(V.value-1,L.value+1)))},Y=A({show:!1,x:0,y:0,items:[],targetIndex:-1,targetAction:null}),q=A({show:!1,action:null}),z=e=>{q.action=e||null,q.show=!0},W=async e=>{try{q.action?(await l.updateAction(q.action.index,e),u("å·²æ›´æ–°")):(await l.addAction(e),u("å·²æ·»åŠ ")),q.show=!1}catch{y("ä¿å­˜å¤±è´¥")}},X=async e=>{try{const a={...e};delete a.index,delete a.id,a.label=a.label+" (å‰¯æœ¬)",await l.addAction(a),u("å·²å¤åˆ¶")}catch{y("å¤åˆ¶å¤±è´¥")}},$=e=>{const a=JSON.stringify(e,null,2),l=new Blob([a],{type:"application/json"}),t=URL.createObjectURL(l),o=document.createElement("a");o.href=t,o.download=`${e.label}.json`,o.click(),URL.revokeObjectURL(t),u("å·²å¯¼å‡º")},G=async e=>{try{await l.deleteAction(e),u("å·²åˆ é™¤")}catch{y("åˆ é™¤å¤±è´¥")}},ne=()=>{_.value=null},ce=()=>{j()?I():t.setShowFlowEditor(!0)};return a(()=>l.fetchActions()),(e,a)=>(d(),o("div",{class:"launcher",onWheel:N},[v("div",{class:"search-bar",onClick:M},[a[3]||(a[3]=v("span",{class:"search-icon"},"ğŸ”",-1)),m(v("input",{ref_key:"searchInput",ref:h,"onUpdate:modelValue":a[0]||(a[0]=e=>b.value=e),placeholder:"æœç´¢åŠ¨ä½œ...",class:"search-field",onInput:O,onKeydown:x(P,["escape"])},null,544),[[g,b.value]]),v("button",{class:"new-flow-btn",onClick:ce,title:"æ–°å»ºæµç¨‹"},"ğŸ”€")]),v("div",Z,r(T.value||"å·¥å…·"),1),v("div",{class:"action-grid",style:s(R.value)},[(d(!0),o(n,null,c(B.value,(e,a)=>{var t;return d(),o("div",{key:a,class:p(["cell",{filled:!!e,empty:!e,dragging:_.value===a}]),draggable:!!e,onClick:a=>e&&H(e.index),onContextmenu:k(l=>e&&((e,a,l)=>{Y.targetIndex=a,Y.targetAction=l,Y.x=e.clientX,Y.y=e.clientY,Y.items=[{label:"æ‰§è¡Œ",icon:"â–¶",action:()=>H(l.index)},{label:"ç¼–è¾‘",icon:"âœ",action:()=>z(l)},{label:"å¤åˆ¶",icon:"ğŸ“‹",action:()=>X(l)},{label:"å¯¼å‡º",icon:"ğŸ“¤",action:()=>$(l)},{label:"åˆ é™¤",icon:"ğŸ—‘",danger:!0,action:()=>G(l.index)}],Y.show=!0})(l,a,e),["prevent"]),onDragstart:e=>((e,a)=>{_.value=a,e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",a.toString()))})(e,a),onDragover:k(e=>((e,a)=>{null!==_.value&&_.value!==a&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move"))})(e,a),["prevent"]),onDrop:e=>(async(e,a)=>{if(e.preventDefault(),null!==_.value&&_.value!==a){const e=B.value[_.value],t=B.value[a];if(e&&void 0!==e.index){const o=e.index,s=(null==t?void 0:t.index)??a;try{await l.reorderActions(o,s),u("å·²ç§»åŠ¨")}catch{y("ç§»åŠ¨å¤±è´¥")}}}_.value=null})(e,a),onDragend:ne},[e?(d(),o(n,{key:0},[v("span",ae,r(e.icon||"âœ¦"),1),v("span",le,r(F(e.label)),1),"combo"===e.type?(d(),o("span",te,r((null==(t=e.steps)?void 0:t.length)||0),1)):i("",!0)],64)):i("",!0)],42,ee)}),128))],4),V.value>1?(d(),o("div",oe,[(d(!0),o(n,null,c(V.value,e=>(d(),o("span",{key:e,class:p(["dot",{active:L.value===e-1}]),onClick:a=>J(e-1)},null,10,se))),128))])):i("",!0),C(S,{show:Y.show,x:Y.x,y:Y.y,items:Y.items,onClose:a[1]||(a[1]=e=>Y.show=!1)},null,8,["show","x","y","items"]),C(Q,{show:q.show,action:q.action,onClose:a[2]||(a[2]=e=>q.show=!1),onSave:W},null,8,["show","action"])],32))}}),[["__scopeId","data-v-da4be6cb"]]);export{ne as default};
